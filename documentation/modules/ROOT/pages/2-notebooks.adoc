= 2. ノートブックの操作 - 10 minutes
:imagesdir: ../assets/images

== 2.1 ノートブック環境の起動

これが初めての方にとって、ノートブックは対話型でコードを簡単に実行できる環境です。これを言うだけで、科学者全般、特にデータ サイエンティストに広く採用されている理由がわかります。実験は通常、このインタラクティブな試行錯誤の方法で行われますが、これを行うのに最適な環境である理由がすぐにわかります。

Jupyter は、カリフォルニア大学バークレー校で開発された主要なオープンソース ノートブック ソリューションであり、OpenShift AI に実装されています。

OpenShift AI で Jupyter ノートブック環境を起動するのは非常に簡単です。

* **Applications->Enabled** メニューから、**Jupyter** タイルの **Launch application** を選択します。

image::launch_jupyter.png[]

これにより、環境を開始するために選択する必要があるさまざまなオプションを含むページが表示されます。

* 使用する **Notebook image** のタイプ。それぞれには、選択した「フレーバー」に応じて、特定のツール、ライブラリ、またはパッケージのセットが付属しています。この概要では、"Standard Data Science" を選択します。これにより、一般的に使用されるデータ サイエンス パッケージのセットが提供されます。

image::standard_data_science.png[]

* 2 番目に選択する必要があるのは、環境の **Deployment size** です。基本的に、これはコードが実行されるポッドに割り当てられるリソース (CPU、RAM) です。サイズが選べる「Tシャツ」のセットです。この Introduction では "Small" 環境を使用します。

image::deployment_size.png[]

* 必要に応じて、環境内で利用可能な NVIDIAGPU がある場合、割り当てられる GPU の数を選択できます。

image::gpu.png[]

* 最後に、生成時に環境に挿入される環境変数を設定できます。これらはチェックボックスをオンにすると ConfigMap として作成されるか、Secret として作成されます。これにより、後でプログラムまたは手動で簡単に変更できます。

image::variables.png[]

* 次に、 **Start Server** を選択します。

image::start_server.png[]

* 環境の起動中に、いくつかの情報が得られます。

image::start.png[]

* 準備ができたら、 **Open in new tab** を選択して環境にアクセスできます。

image::open_new_tab.png[]

* 再度ログインする必要があり、初めて環境にアクセスするときに、さまざまな情報へのアクセスを承認します。

 * *Username*: `%USERID%`
 * *Password*: `{openshift-password}`

image::authorize.png[]

* Congratulations, you just launched your Jupyter Lab environment!

image::jupyterlab.png[]

== 2.2. JupyterLab の使用

*JupyterLab* は、主に **ノートブック** を操作できる IDE です。ご覧のとおり、これは Web ベースの環境ですが、ここで行うことはすべて、実際にはイメージとサイズを選択した Pod 内の Red Hat OpenShift AI 上で行われます。

つまり、自分のコンピューターに何もインストールして保守する必要がなく、CPU や RAM などの多くのローカル リソースを破棄することなく、この強力で安定した管理された環境でデータ サイエンス作業を行うことができます。

左側の *ファイルブラウザのような* パネルには、Red Hat OpenShift AI 内の個人用スペース内に保存されているファイルとフォルダーが表示されます。今はかなり空いてますけどね。そこで最初にやることは、ワークショップの内容をこの環境内に取り込むことです。

* 左側のツールバーで、Git アイコンを選択します。

image::git.png[]

* 次に、 `Clone a Repository` を選択します。

image::git_clone.png[]

* URL https://github.com/team-ohc-jp-place/mad_m6_workshop.git を入力し、 `Clone` を選択します。

image::clone_repo.png[]

* この操作は数秒かかります。その後、ダブルクリックして、新しく作成したフォルダー **mad_m6_workshop** に移動できます。

image::open_mad_workshop.png[]

これでノートブックを使用する準備が整いました！

== 2.3. ノートブックの操作

このセクションでは、Jupyter Notebook の使用方法について簡単に紹介します。すでに Jupyter に慣れている場合は、link:3-model-training.html[次のセクション] に直接移動できます。

=== 2.3.1. ノートブックとは？

* ノートブックは、書式設定されたテキストまたはコードを表示できるセルがある環境です。

これは空のセルです。

image::empty_cell.png[]

そして、コードを入力したセルです。

image::cell_with_code.png[]

* コード セルには、対話的に実行できる Python コードが含まれています。これは、コードを変更して実行できることを意味しますが、それはこのセルに対してのみであり、ノートブックのコンテンツ全体に対しては実行できないということです。コードはコンピューターやブラウザーでは実行されず、接続している環境である Red Hat OpenShift AI で直接実行されます。

* コード セルを実行するには、セルを選択し (セルまたはその左側を選択)、ツールバーから Run/Play ボタンを選択します (CTRL+Enter を押してセルを実行するか、Shift+ Enter を押すとセルが実行され、次のセルが自動的に選択されます)。

ツールバーの Run ボタン:

image::run_cell.png[]

ご覧のとおり、そのセルで実行されたコードの結果 (コードが何らかの出力を生成する場合) と、この特定のセルがいつ実行されたかに関する情報が取得されます。

* ノートブックを保存すると、コードとすべての結果が保存されます。したがって、すべてのプログラムを再度実行する必要がなく、このコンテンツを生成したコードに引き続きアクセスしながら、いつでも再度開いて結果を確認できます。

ノートブックは物理的なノートに似ているため、このように名付けられました。これは、設定したパラメーターを含むコード自体とともに、(これから行う) 実験についてメモを取っているのとまったく同じです。実験の出力がインラインで表示されます (これは、実行後のセルの結果です)。また、実験の出力（セルが実行された後の結果）が、必要なすべてのノートとともにインラインで表示されます。メニューからセルの種類を `Code` から `Markup`　に切り替えることができます。

=== 2.3.2. 実験してみましょう！

基本を説明したので、ぜひ試してみてください。

Jupyter 環境では、左側のファイル エクスプローラーに `01_sanbdbox.ipynb` というファイルがあります。これをダブルクリックしてノートブックを起動します (環境の右側のコンテンツ セクションに別のタブが開きます)。自由に実験したり、さまざまなセルを実行したり、コードを追加したりしてください...やりたいことを自由に実行できます。これはあなたの環境であり、何かを壊したり他のユーザーに影響を与えたりするリスクはありません。この環境の分離は、Red Hat OpenShift AI によってもたらされる大きな利点でもあります。

左上のメニューから `File->New->Notebook` を選択し、Python 3 カーネルを選択して、新しいノートブックを作成することもできます。これにより、Python 3 カーネルを使用してコード セルが実行される新しいノートブックを作成するよう Jupyter に指示されます。ノートブックで実行できるさまざまな言語やバージョンのさまざまなカーネルを使用することもできますが、それについてはまた別の機会にお話しします。

ランチャーでアイコンを選択するだけでノートブックを作成することもできます。

image::launch_notebook_icon.png[]

ノートブックについて詳しく知りたい場合は、 https://jupyter.org/[このページ^] にアクセスしてください。
